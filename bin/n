#!/bin/bash

# time the command
let start_time=`date +%s`;
time "$@";
rval=$?;
let end_time=`date +%s`;
let duration=`expr $end_time - $start_time`;

# emit a notification if the command took longer than 2 seconds
if [ $duration -ge 2 ] ; then
    # try to emit a growl-style notification
    if hash osascript 2>/dev/null; then
        # OS X
        osascript \
            -e "on run(argv)" \
            -e "return display notification item 1 of argv with title item 2 of argv" \
            -e "end" \
            -- "$rval" "$@"
    elif hash notify-send 2>/dev/null; then
        # Debian
        notify-send --app-name='Terminal' --icon='terminal' "$1" "$rval"
    fi

    # and try to make a beep noise
    echo ;
fi

exit $rval;
