- name: create ssh directory
  file:
    path: "/home/{{ whoami }}/.ssh"
    state: directory
    owner: "{{ whoami }}"
    group: "{{ whoami }}"

- name: generate ssh identity
  openssh_keypair:
    path: "/home/{{ whoami }}/.ssh/id_rsa"
    size: 4096
    comment: "{{ whoami }}@{{ ansible_hostname }}"
    owner: "{{ whoami }}"
    group: "{{ whoami }}"

- name: create an SSH config file
  file:
    path: "/home/{{ whoami }}/.ssh/config"
    state: touch
    owner: "{{ whoami }}"
    group: "{{ whoami }}"
    mode: 0600
